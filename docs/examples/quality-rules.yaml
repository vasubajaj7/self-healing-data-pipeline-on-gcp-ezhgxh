version: '1.0.0'
description: 'Example quality validation rules for the self-healing data pipeline'
rules:
  - rule_id: 'rule-schema-001'
    name: 'Customer Table Schema Validation'
    description: 'Validates the schema of the customer table against expected structure'
    rule_type: 'SCHEMA'
    subtype: 'schema_consistency'
    dimension: 'CONSISTENCY'
    target_dataset: 'customer_data'
    target_table: 'customers'
    parameters:
      expected_schema:
        customer_id: 'STRING'
        first_name: 'STRING'
        last_name: 'STRING'
        email: 'STRING'
        phone_number: 'STRING'
        address: 'STRING'
        city: 'STRING'
        state: 'STRING'
        zip_code: 'STRING'
        registration_date: 'TIMESTAMP'
        last_purchase_date: 'TIMESTAMP'
        total_purchases: 'INTEGER'
        lifetime_value: 'FLOAT'
    metadata:
      severity: 'HIGH'
      owner: 'data_governance_team'
      tags: ['schema', 'customer', 'critical']
    enabled: true

  - rule_id: 'rule-schema-002'
    name: 'Sales Table Primary Key Check'
    description: 'Validates that the sales table has a unique primary key'
    rule_type: 'SCHEMA'
    subtype: 'primary_key'
    dimension: 'UNIQUENESS'
    target_dataset: 'sales_metrics'
    target_table: 'sales'
    parameters:
      key_columns: ['sale_id']
    metadata:
      severity: 'CRITICAL'
      owner: 'data_engineering_team'
      tags: ['schema', 'sales', 'primary_key']
    enabled: true

  - rule_id: 'rule-schema-003'
    name: 'Product Catalog Column Existence'
    description: 'Validates that required columns exist in the product catalog table'
    rule_type: 'SCHEMA'
    subtype: 'column_existence'
    dimension: 'COMPLETENESS'
    target_dataset: 'product_catalog'
    target_table: 'products'
    parameters:
      columns: ['product_id', 'product_name', 'category', 'price', 'inventory_count', 'description']
    metadata:
      severity: 'HIGH'
      owner: 'product_team'
      tags: ['schema', 'product', 'required_columns']
    enabled: true

  - rule_id: 'rule-content-001'
    name: 'Customer Email Not Null'
    description: 'Validates that customer email addresses are not null'
    rule_type: 'CONTENT'
    subtype: 'not_null'
    dimension: 'COMPLETENESS'
    target_dataset: 'customer_data'
    target_table: 'customers'
    parameters:
      columns: ['email']
    metadata:
      severity: 'MEDIUM'
      owner: 'marketing_team'
      tags: ['content', 'customer', 'email']
    enabled: true

  - rule_id: 'rule-content-002'
    name: 'Product Price Range Check'
    description: 'Validates that product prices fall within an acceptable range'
    rule_type: 'CONTENT'
    subtype: 'value_range'
    dimension: 'VALIDITY'
    target_dataset: 'product_catalog'
    target_table: 'products'
    parameters:
      column: 'price'
      min_value: 0.01
      max_value: 10000.0
    metadata:
      severity: 'HIGH'
      owner: 'product_team'
      tags: ['content', 'product', 'price']
    enabled: true

  - rule_id: 'rule-content-003'
    name: 'Email Format Validation'
    description: 'Validates that email addresses match a valid email pattern'
    rule_type: 'CONTENT'
    subtype: 'pattern'
    dimension: 'VALIDITY'
    target_dataset: 'customer_data'
    target_table: 'customers'
    parameters:
      column: 'email'
      pattern: '^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$'
    metadata:
      severity: 'MEDIUM'
      owner: 'data_quality_team'
      tags: ['content', 'customer', 'email', 'pattern']
    enabled: true

  - rule_id: 'rule-content-004'
    name: 'State Code Validation'
    description: 'Validates that state codes are valid US state abbreviations'
    rule_type: 'CONTENT'
    subtype: 'categorical'
    dimension: 'ACCURACY'
    target_dataset: 'customer_data'
    target_table: 'customers'
    parameters:
      column: 'state'
      allowed_values: ['AL', 'AK', 'AZ', 'AR', 'CA', 'CO', 'CT', 'DE', 'FL', 'GA', 'HI', 'ID', 'IL', 'IN', 'IA', 'KS', 'KY', 'LA', 'ME', 'MD', 'MA', 'MI', 'MN', 'MS', 'MO', 'MT', 'NE', 'NV', 'NH', 'NJ', 'NM', 'NY', 'NC', 'ND', 'OH', 'OK', 'OR', 'PA', 'RI', 'SC', 'SD', 'TN', 'TX', 'UT', 'VT', 'VA', 'WA', 'WV', 'WI', 'WY', 'DC', 'PR', 'VI']
    metadata:
      severity: 'LOW'
      owner: 'data_quality_team'
      tags: ['content', 'customer', 'state', 'categorical']
    enabled: true

  - rule_id: 'rule-relationship-001'
    name: 'Sales Product ID Foreign Key Check'
    description: 'Validates that product IDs in sales table exist in the products table'
    rule_type: 'RELATIONSHIP'
    subtype: 'referential_integrity'
    dimension: 'CONSISTENCY'
    target_dataset: 'sales_metrics'
    target_table: 'sales'
    parameters:
      source_column: 'product_id'
      reference_dataset: 'product_catalog'
      reference_table: 'products'
      reference_column: 'product_id'
    metadata:
      severity: 'HIGH'
      owner: 'data_engineering_team'
      tags: ['relationship', 'sales', 'product', 'foreign_key']
    enabled: true

  - rule_id: 'rule-relationship-002'
    name: 'Order Items Order ID Foreign Key Check'
    description: 'Validates that order IDs in order_items table exist in the orders table'
    rule_type: 'RELATIONSHIP'
    subtype: 'referential_integrity'
    dimension: 'CONSISTENCY'
    target_dataset: 'sales_metrics'
    target_table: 'order_items'
    parameters:
      source_column: 'order_id'
      reference_dataset: 'sales_metrics'
      reference_table: 'orders'
      reference_column: 'order_id'
    metadata:
      severity: 'HIGH'
      owner: 'data_engineering_team'
      tags: ['relationship', 'orders', 'order_items', 'foreign_key']
    enabled: true

  - rule_id: 'rule-statistical-001'
    name: 'Daily Sales Anomaly Detection'
    description: 'Detects anomalies in daily sales totals'
    rule_type: 'STATISTICAL'
    subtype: 'anomaly_detection'
    dimension: 'ACCURACY'
    target_dataset: 'sales_metrics'
    target_table: 'daily_sales'
    parameters:
      column: 'total_sales'
      time_column: 'sale_date'
      method: 'z_score'
      threshold: 3.0
      window_size: 30
    metadata:
      severity: 'MEDIUM'
      owner: 'analytics_team'
      tags: ['statistical', 'sales', 'anomaly']
    enabled: true

  - rule_id: 'rule-statistical-002'
    name: 'Product Price Distribution Check'
    description: 'Validates that product prices follow expected distribution'
    rule_type: 'STATISTICAL'
    subtype: 'distribution_check'
    dimension: 'CONSISTENCY'
    target_dataset: 'product_catalog'
    target_table: 'products'
    parameters:
      column: 'price'
      distribution: 'log_normal'
      significance_level: 0.05
    metadata:
      severity: 'LOW'
      owner: 'data_science_team'
      tags: ['statistical', 'product', 'price', 'distribution']
    enabled: true

  - rule_id: 'rule-statistical-003'
    name: 'Customer Lifetime Value Outlier Detection'
    description: 'Detects outliers in customer lifetime value'
    rule_type: 'STATISTICAL'
    subtype: 'outlier_detection'
    dimension: 'ACCURACY'
    target_dataset: 'customer_data'
    target_table: 'customers'
    parameters:
      column: 'lifetime_value'
      method: 'iqr'
      factor: 1.5
    metadata:
      severity: 'LOW'
      owner: 'marketing_team'
      tags: ['statistical', 'customer', 'lifetime_value', 'outlier']
    enabled: true

  - rule_id: 'rule-content-005'
    name: 'Order Date Timeliness Check'
    description: 'Validates that order dates are not too old or in the future'
    rule_type: 'CONTENT'
    subtype: 'value_range'
    dimension: 'TIMELINESS'
    target_dataset: 'sales_metrics'
    target_table: 'orders'
    parameters:
      column: 'order_date'
      min_value: 'DATE_SUB(CURRENT_DATE(), INTERVAL 1 YEAR)'
      max_value: 'CURRENT_DATE()'
      is_expression: true
    metadata:
      severity: 'MEDIUM'
      owner: 'operations_team'
      tags: ['content', 'orders', 'date', 'timeliness']
    enabled: true

rule_sets:
  - set_id: 'customer_data_quality'
    name: 'Customer Data Quality Rules'
    description: 'Collection of rules for validating customer data quality'
    rules: ['rule-schema-001', 'rule-content-001', 'rule-content-003', 'rule-content-004', 'rule-statistical-003']
    metadata:
      owner: 'data_governance_team'
      priority: 'HIGH'

  - set_id: 'product_data_quality'
    name: 'Product Data Quality Rules'
    description: 'Collection of rules for validating product data quality'
    rules: ['rule-schema-003', 'rule-content-002', 'rule-statistical-002']
    metadata:
      owner: 'product_team'
      priority: 'MEDIUM'

  - set_id: 'sales_data_quality'
    name: 'Sales Data Quality Rules'
    description: 'Collection of rules for validating sales data quality'
    rules: ['rule-schema-002', 'rule-relationship-001', 'rule-relationship-002', 'rule-statistical-001', 'rule-content-005']
    metadata:
      owner: 'sales_team'
      priority: 'HIGH'

quality_thresholds:
  critical: 1.0
  high: 0.95
  medium: 0.9
  low: 0.8

execution_config:
  timeout_seconds: 300
  max_sample_size: 100000
  parallel_execution: true
  fail_fast: true